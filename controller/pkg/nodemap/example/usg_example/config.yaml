# global_naming:
#   policy_template: "{PREFIX}{SITE}_{PURPOSE}_{APP}_{SEQ}{SUFFIX}"
#   object_template: "{TYPE}_{CONTENT}_{SEQ}"
#   acl_template: "ACL_{DIRECTION}_{APP}_{SEQ}"
#   nat_template: "NAT_{TYPE}_{APP}_{SEQ}"
#   defaults:
#     prefix: ""
#     suffix: ""
#     site: "DEFAULT"
#     environment: "PROD"


# devices:
#   - host: "172.32.1.224"
#     username: "sshadmin"
#     password: "admin@123"
#     port: 22
#     mode: "Huawei"
#     telnet: false
#     ipv4_area:
#       - interface: "Eth-Trunk2.10"
#         name: "QXDCN"
#         node_name: "USG6000V2"
#         force: true
#     ipv4_stub:
#       - port_name: "Eth-Trunk2.11"
#       - port_name: "Eth-Trunk2.12"
#       - port_name: "Eth-Trunk2.13"
#       - port_name: "Eth-Trunk2.14"
#       - port_name: "Eth-Trunk2.15"
#       - port_name: "Eth-Trunk2.16"
#       - port_name: "Eth-Trunk2.17"
#       - port_name: "Eth-Trunk2.18"
#       - port_name: "Eth-Trunk2.19"
#       - port_name: "Eth-Trunk2.20"
#       - port_name: "Eth-Trunk2.21"
#       - port_name: "Eth-Trunk2.22"
#     naming:
#       policy_name_template: "JiS_policy_{SEQ:ID:5:10000:1:MAIN}"
#       object_template: "{SITE}_{TYPE}_{CONTENT}_{SEQ}"
#     metadata:
#       type: "object"
#       policy_name_template: "JiS_policy_{SEQ:ID:5:10000:1:MAIN}"
#       object_template: "{SITE}_{TYPE}_{CONTENT}_{SEQ}"
#       input.nat: "natpolicy.dnat"   # Input NAT policy(nat.static.inbound, nat.static.inout)
#       output.nat: "natpolicy.snat"  # Output NAT policy(nat.static.outbound, nat.dynamic.outbound)
#       # nat.enableAclGeneration: "true"
#       natpolicy.snat.object_style: "true"
#       natpolicy.snat.source_object: "false"
#       natpolicy.snat.destination_object: "false"
#       natpolicy.snat.service_object: "true"
#       natpolicy.dnat.object_style: "true"
#       natpolicy.dnat.source_object: "false"
#       natpolicy.dnat.destination_object: "false"
#       natpolicy.dnat.service_object: "true"
#       securitypolicy.object_style: "true"
#       securitypolicy.source_object: "false"
#       securitypolicy.destination_object: "false"
#       securitypolicy.service_object: "true"
      
#   - host: "172.32.1.225"
#     username: "admin"
#     password: "!@AsiaLink@2020"
#     port: 22
#     mode: "SecPath"
#     telnet: false
#     ipv4_area:
#       - interface: "Eth-Trunk2.10"
#         name: "QXDCN"
#         node_name: "USG6000V2"
#         force: true
#     metadata:
#       base_acl_number: "3200"
#       input.nat: "natpolicy.dnat"   # Input NAT policy(nat.static.inbound, nat.static.inout)
#       output.nat: "natpolicy.snat"  # Output NAT policy(nat.static.outbound, nat.dynamic.outbound)
#       # nat.enableAclGeneration: "true"
#       policy_name_template: "JiS_policy_{SEQ:ID:5:10000:1:MAIN}"
#       natpolicy.snat.object_style: "true"
#       natpolicy.snat.source_object: "false"
#       natpolicy.snat.destination_object: "false"
#       natpolicy.snat.service_object: "true"
#       natpolicy.dnat.object_style: "true"
#       natpolicy.dnat.source_object: "false"
#       natpolicy.dnat.destination_object: "false"
#       natpolicy.dnat.service_object: "true"
#       securitypolicy.object_style: "true"
#       securitypolicy.source_object: "false"
#       securitypolicy.destination_object: "false"
#       securitypolicy.service_object: "true"
      



devices:
  - file_path: "2025-05-30-08.47.23-132.252.148.65-NJ-GL4F-G16U5-FW.RP.M9010.txt"
    mode: "SecPath"
    ipv4_area:
      - interface: "Route-Aggregation12.1051"
        name: "QXDCN"
        node_name: "NJ-GL4F-G16U5-FW.RP.M9010"
        force: true
    # 地址列表配置：用于通过地址列表匹配来定位源节点
    # 优先级：地址列表匹配 > 端口网络匹配 > Stub节点 > Outside节点
    ipv4_address_list:
      # 示例1：指定特定IP地址列表，关联到特定节点和接口
      - name: "DMZ_Servers"
        addresses:
          - "192.168.1.10"
          - "192.168.1.11"
          - "192.168.1.12"
        node_name: "NJ-GL4F-G16U5-FW.RP.M9010"
        interface: "Route-Aggregation12.1051"
        vrf: ""  # 可选，如果指定则只在该VRF中匹配
        priority: 0  # 优先级，数字越小优先级越高
      # 示例2：使用CIDR网段
      - name: "Internal_Network"
        addresses:
          - "10.0.0.0/8"
          - "172.16.0.0/12"
        node_name: "NJ-GL4F-G16U5-FW.RP.M9010"
        interface: ""  # 如果为空，则通过路由查询确定接口
        priority: 1
      # 示例3：使用IP范围
      - name: "Server_Range"
        addresses:
          - "192.168.1.1-192.168.1.100"
        node_name: "NJ-GL4F-G16U5-FW.RP.M9010"
        interface: "Route-Aggregation12.1051"
        priority: 2
    ipv4_stub:
      - port_name: "Route-Aggregation12.1052"
      - port_name: "Route-Aggregation12.1058"
      - port_name: "Route-Aggregation12.1054"
      - port_name: "Route-Aggregation12.1061"
      - port_name: "Route-Aggregation12.1053"
      - port_name: "Route-Aggregation12.1059"
      - port_name: "Route-Aggregation12.1055"
      - port_name: "Route-Aggregation12.1062"
      - port_name: "Route-Aggregation12.1057"
      - port_name: "Route-Aggregation12.1060"
      - port_name: "Route-Aggregation12.1063"
      - port_name: "Route-Aggregation12.1056"
    metadata:
      # base_acl_number: "3200"
      # input.nat: "natpolicy.dnat"   # Input NAT policy(nat.static.inbound, nat.static.inout)
      # output.nat: "natpolicy.snat"  # Output NAT policy(nat.static.outbound, nat.dynamic.outbound)
      # nat.enableAclGeneration: "true"
      policy_name_template: "GL4F-policy{SEQ:id:4:1:1:MAIN}"
      service_object_name_template: |
        result = ""
        if service.protocol.Equal("IP"):
          pass
        elif service.protocol.Equal("TCP") or service.protocol.Equal("UDP"):
          result = str(service.protocol)
          if service.hasDstPort:
            if service.dst_port.count == 1:
              result = result + "_" + service.dst_port.compact
            else:
              result = result + "_" + service.dst_port.first + "_" + service.dst_port.last
        elif service.protocol.Equal("ICMP"):
          result = str(service.protocol)
          if service.hasType:
            result = result + "_" + str(service.type)
            if service.hasCode:
              result = result + "_" + str(service.code)
        else:
          result = str(service.protocol) + "_" + str(service.protocol.number)
        result
      network_object_name_template: |
        result = "DMZ_"
        if network.type=="RANGE":
            result = result + network.first + "_" + network.last
        elif network.type=="SUBNET":
            result = result + network.cidr
        elif network.type=="HOST":
            result = result + network.ip
        result
      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      action:                            pass

  - file_path: "2025-05-30-08.49.06-132.252.20.85-NJ-JiS-E16&17-FW-3.DMZ.F5000.txt"
    mode: "SecPath"
    ipv4_area:
      - interface: "Reth5"
        name: "163"
        node_name: "NJ-JiS-E16&17-FW-3.DMZ.F5000"
        force: true
      - interface: "Reth4"
        name: "QXDCN"
        node_name: "NJ-JiS-E16&17-FW-3.DMZ.F5000"
        force: true
    ipv4_stub:
      - port_name: "Reth3"
    metadata:
      # base_acl_number: "3200"
      # input.nat: "natpolicy.dnat"   # Input NAT policy(nat.static.inbound, nat.static.inout)
      # output.nat: "natpolicy.snat"  # Output NAT policy(nat.static.outbound, nat.dynamic.outbound)
      # nat.enableAclGeneration: "true"
      policy_name_template: "JiS_DMZ_{SEQ:id:3:1:1:MAIN}"
      service_object_name_template: |
        result = ""
        if service.protocol.Equal("IP"):
          pass
        elif service.protocol.Equal("TCP") or service.protocol.Equal("UDP"):
          result = str(service.protocol)
          if service.hasDstPort:
            if service.dst_port.count == 1:
              result = result + "_" + service.dst_port.compact
            else:
              result = result + "_" + service.dst_port.first + "_" + service.dst_port.last
        elif service.protocol.Equal("ICMP"):
          result = str(service.protocol)
          if service.hasType:
            result = result + "_" + str(service.type)
            if service.hasCode:
              result = result + "_" + str(service.code)
        else:
          result = str(service.protocol) + "_" + str(service.protocol.number)
        result
      network_object_name_template: |
        result = "DMZ_"
        if network.type=="RANGE":
            result = result + network.first + "_" + network.last
        elif network.type=="SUBNET":
            result = result + network.cidr
        elif network.type=="HOST":
            result = result + network.ip
        result
      
      # network_object_name_template: |
      #   {if:exist:single_rule=="true"}DMZ_{ip}
      #   {else}
      #     {if:exist:object_name=="true"}
      #         {object_name}
      #     {else}
      #       {if:exist:policy_name=="true"}
      #         {policy_name}{if:exist:is_source=="true"}_src_addr{else}_dst_addr{endif}
      #       {endif}	
      #     {endif}
      #   {endif}
      securitypolicy.object_style:       true
      securitypolicy.source_object:      true
      securitypolicy.destination_object: true
      securitypolicy.service_object:     true
      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      action:                            pass

  - file_path: "2025-05-30-08.49.40-132.239.180.12-CZ-LY-FW-1.BD.F5000.txt"
    mode: "SecPath"
    ipv4_area:
      - interface: "Route-Aggregation14.100"
        name: "QXDCN"
        node_name: "CZ-LY-FW-1.BD.F5000"
        force: true
    ipv4_stub:
      - port_name: "Route-Aggregation14.103"
      - port_name: "Route-Aggregation14.101"
      - port_name: "Route-Aggregation14.102"
    metadata:
      # base_acl_number: "3200"
      # input.nat: "natpolicy.dnat"   # Input NAT policy(nat.static.inbound, nat.static.inout)
      # output.nat: "natpolicy.snat"  # Output NAT policy(nat.static.outbound, nat.dynamic.outbound)
      # nat.enableAclGeneration: "true"
      policy_name_template: "LY_policy_{SEQ:id:4:1:1:MAIN}"
      service_object_name_template: |
        result = ""
        if service.protocol.Equal("IP"):
          pass
        elif service.protocol.Equal("TCP") or service.protocol.Equal("UDP"):
          result = str(service.protocol)
          if service.hasDstPort:
            if service.dst_port.count == 1:
              result = result + "_" + service.dst_port.compact
            else:
              result = result + "_" + service.dst_port.first + "_" + service.dst_port.last
        elif service.protocol.Equal("ICMP"):
          result = str(service.protocol)
          if service.hasType:
            result = result + "_" + str(service.type)
            if service.hasCode:
              result = result + "_" + str(service.code)
        else:
          result = str(service.protocol) + "_" + str(service.protocol.number)
        result
      network_object_name_template: |
        result = ""
        if meta.get("isSourceStubArea") == True and meta.get("is_source"):
            result = result + meta.get("fromZone") + "_"
        if meta.get("isDestinationStubArea") == True and meta.get("is_source") == False:
            result = result + meta.get("toZone") + "_"
        if network.type=="RANGE":
            result = result + network.first + "_" + network.last
        elif network.type=="SUBNET":
            result = result + network.cidr
        elif network.type=="HOST":
            result = result + network.ip
        result
      address_group_name_template: |
        result = ""
        if meta.get("policy_name") and meta.get("policy_name") != "":
            result = meta.get("policy_name", "") + "_" + ("src" if meta.get("is_source") == "true" or meta.get("is_source") == True else "dst") + "_addr01"
        elif meta.get("nat_name") and meta.get("nat_name") != "":
            result = meta.get("nat_name", "") + "_" + ("src" if meta.get("is_source") == "true" or meta.get("is_source") == True else "dst") + "_addr01"
        else:
            result = ("src" if meta.get("is_source") == "true" or meta.get("is_source") == True else "dst") + "_addr01"
        result
      securitypolicy.use_source_address_object:      true
      securitypolicy.use_destination_address_object: true
      securitypolicy.use_service_object: true
      securitypolicy.reuse_policy:                      true
      securitypolicy.reuse_policy_mode: "enhanced"
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      securitypolicy.multi_source_address_object: false
      securitypolicy.multi_destination_address_object: false
      securitypolicy.multi_service_object: true
      securitypolicy.reuse_service_object: true
      securitypolicy.source_address_group_style: "inline"
      securitypolicy.destination_address_group_style: "inline"
      action:                            pass
  - file_path: "2025-05-30-08.51.44-132.254.194.188-H3C-F5K-DMZ-仪征403.txt"
    mode: "SecPath"
    ipv4_area:
      - interface: "Route-Aggregation2.1203"
        name: "163"
        node_name: "CTY-YZ-JS-YZ-MTDD-01D04F403-J01_12-02U23-H3C-F5000-NFW"
        force: true
    ipv4_stub:
      - port_name: "Route-Aggregation2.1204"
    metadata:
      securitypolicy.object_style:       true
      securitypolicy.source_object:      true
      securitypolicy.destination_object: true
      securitypolicy.service_object:     true
      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      action:                            pass
  - file_path: "2025-05-30-08.48.03-132.252.20.11-NJ-JiS-E24-FW-1.RP.Edu8000E.txt"
    mode: "Huawei"
    ipv4_area:
      - interface: "Eth-Trunk2.10"
        name: "QXDCN"
        node_name: "NJ-JiS-E24-FW-1.RP.Edu8000E"
        force: true
    ipv4_stub:
      - port_name: "Eth-Trunk2.12"
      - port_name: "Eth-Trunk2.16"
      - port_name: "Eth-Trunk2.19"
      - port_name: "Eth-Trunk2.15"
      - port_name: "Eth-Trunk2.20"
      - port_name: "Eth-Trunk2.22"
      - port_name: "Eth-Trunk2.11"
      - port_name: "Eth-Trunk2.14"
      - port_name: "Eth-Trunk2.17"
      - port_name: "Eth-Trunk2.18"
      - port_name: "Eth-Trunk2.13"
      - port_name: "Eth-Trunk2.21"
    metadata:
      type: "object"
      policy_name_template: "JiS_policy_{SEQ:id:4:1:1:MAIN}"
      service_object_name_template: |
        result = ""
        if service.protocol.Equal("IP"):
          pass
        elif service.protocol.Equal("TCP") or service.protocol.Equal("UDP"):
          result = str(service.protocol)
          if service.hasDstPort:
            if service.dst_port.count == 1:
              result = result + "_" + service.dst_port.compact
            else:
              result = result + "_" + service.dst_port.first + "_" + service.dst_port.last
        elif service.protocol.Equal("ICMP"):
          result = str(service.protocol)
          if service.hasType:
            result = result + "_" + str(service.type)
            if service.hasCode:
              result = result + "_" + str(service.code)
        else:
          result = str(service.protocol) + "_" + str(service.protocol.number)
        result
      network_object_name_template: |
        result = "DMZ_"
        if network.type=="RANGE":
            result = result + network.first + "_" + network.last
        elif network.type=="SUBNET":
            result = result + network.cidr
        elif network.type=="HOST":
            result = result + network.ip
        result

      securitypolicy.object_style:       false
      securitypolicy.source_object:      false
      securitypolicy.destination_object: false
      securitypolicy.service_object:     false
      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            true
      action:                            permit

  - file_path: "2025-05-30-08.48.37-132.252.20.83-NJ-JiS-E19-FW-1.DMZ.DP1000.txt"
    mode: "Dptech"
    ipv4_area:
      - interface: "bond12"
        name: "DMZ"
        node_name: "NJ-JiS-E19-FW-1.DMZ.DP1000"
        force: true
    ipv4_stub:
      - port_name: "bond11"
    metadata:
      policy_name_template: "DMZ_{VAR:system_name}_policy{SEQ:id:2:1:1:MAIN}"
      service_object_name_template: |
        result = ""
        if service.protocol.Equal("IP"):
          pass
        elif service.protocol.Equal("TCP") or service.protocol.Equal("UDP"):
          result = str(service.protocol)
          if service.hasDstPort:
            if service.dst_port.count == 1:
              result = result + "_" + service.dst_port.compact
            else:
              result = result + "_" + service.dst_port.first + "_" + service.dst_port.last
        elif service.protocol.Equal("ICMP"):
          result = str(service.protocol)
          if service.hasType:
            result = result + "_" + str(service.type)
            if service.hasCode:
              result = result + "_" + str(service.code)
        else:
          result = str(service.protocol) + "_" + str(service.protocol.number)
        result
      network_object_name_template: |
        result = ""
        if meta.get("isSourceStubArea") == True and meta.get("is_source"):
            result = result + meta.get("fromZone") + "_"
        if meta.get("isDestinationStubArea") == True and meta.get("is_source") == False:
            result = result + meta.get("toZone") + "_"
        if network.type=="RANGE":
            result = result + network.first + "_" + network.last
        elif network.type=="SUBNET":
            result = result + network.cidr
        elif network.type=="HOST":
            result = result + network.ip
        result
      address_group_name_template: |
        result = ""
        if meta.get("policy_name") and meta.get("policy_name") != "":
            result = meta.get("policy_name", "") + "_" + ("src" if meta.get("is_source") == "true" or meta.get("is_source") == True else "dst") + "_addr01"
        elif meta.get("nat_name") and meta.get("nat_name") != "":
            result = meta.get("nat_name", "") + "_" + ("src" if meta.get("is_source") == "true" or meta.get("is_source") == True else "dst") + "_addr01"
        else:
            result = ("src" if meta.get("is_source") == "true" or meta.get("is_source") == True else "dst") + "_addr01"
        result
      securitypolicy.use_source_address_object: true
      securitypolicy.use_destination_address_object: true
      securitypolicy.use_service_object: false
      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      securitypolicy.multi_source_address_object: false
      securitypolicy.multi_destination_address_object: true
      securitypolicy.multi_service_object: false
      securitypolicy.source_address_group_style: "member"
      securitypolicy.destination_address_group_style: "member"
      securitypolicy.service_group_style: "inline"      # multi_service_object为false才有有效  
      action:    permit     

  - file_path: "2025-05-30-08.50.14-132.254.194.222-DP1000-容灾备份-仪征403.txt"
    mode: "Dptech"
    ipv4_area:
      - interface: "vlan-if1208"
        name: "Untrust"
        node_name: "CTY-YZ-JS-YZ-MTDD-01D04F403-A13-06U19-DP-FW1000-NFW"
        force: true
    ipv4_stub:
      - port_name: "vlan-if1209"
    metadata:
      # base_acl_number: "3200"
      # input.nat: "natpolicy.dnat"   # Input NAT policy(nat.static.inbound, nat.static.inout)
      # output.nat: "natpolicy.snat"  # Output NAT policy(nat.static.outbound, nat.dynamic.outbound)
      # nat.enableAclGeneration: "true"
      policy_name_template: "iboc_policy_{DATE:date:YYYYMMDD}_{SEQ:id:2:1:1:MAIN}"
      service_object_name_template: |
        result = ""
        if service.protocol.Equal("IP"):
          pass
        elif service.protocol.Equal("TCP") or service.protocol.Equal("UDP"):
          result = str(service.protocol)
          if service.hasDstPort:
            if service.dst_port.count == 1:
              result = result + "_" + service.dst_port.compact
            else:
              result = result + "_" + service.dst_port.first + "_" + service.dst_port.last
        elif service.protocol.Equal("ICMP"):
          result = str(service.protocol)
          if service.hasType:
            result = result + "_" + str(service.type)
            if service.hasCode:
              result = result + "_" + str(service.code)
        else:
          result = str(service.protocol) + "_" + str(service.protocol.number)
        result
      network_object_name_template: |
        result = "DMZ_"
        if network.type=="RANGE":
            result = result + network.first + "_" + network.last
        elif network.type=="SUBNET":
            result = result + network.cidr
        elif network.type=="HOST":
            result = result + network.ip
        result
      securitypolicy.object_style:       true
      securitypolicy.source_object:      true
      securitypolicy.destination_object: true
      securitypolicy.service_object:     false
      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      action:                            permit

  - file_path: "2025-05-30-08.50.44-132.254.194.147-DP1000-虚机资源池-仪征403.txt"
    mode: "Dptech"
    ipv4_area:
      - interface: "vlan-if4001"
        name: "Untrust"
        node_name: "CTY-YZ-JS-YZ-MTDD-01D04F403-J02_06-07U16-DP-FW1000-NFW"
        force: true
    ipv4_stub:
      - port_name: "vlan-if4002"
    metadata:
      # base_acl_number: "3200"
      # input.nat: "natpolicy.dnat"   # Input NAT policy(nat.static.inbound, nat.static.inout)
      # output.nat: "natpolicy.snat"  # Output NAT policy(nat.static.outbound, nat.dynamic.outbound)
      # nat.enableAclGeneration: "true"
      policy_name_template: "iboc_policy_{DATE:date:YYYYMMDD}_{SEQ:id:2:1:1:MAIN}"
      service_object_name_template: |
        result = ""
        if service.protocol.Equal("IP"):
          pass
        elif service.protocol.Equal("TCP") or service.protocol.Equal("UDP"):
          result = str(service.protocol)
          if service.hasDstPort:
            if service.dst_port.count == 1:
              result = result + "_" + service.dst_port.compact
            else:
              result = result + "_" + service.dst_port.first + "_" + service.dst_port.last
        elif service.protocol.Equal("ICMP"):
          result = str(service.protocol)
          if service.hasType:
            result = result + "_" + str(service.type)
            if service.hasCode:
              result = result + "_" + str(service.code)
        else:
          result = str(service.protocol) + "_" + str(service.protocol.number)
        result
      network_object_name_template: |
        result = "DMZ_"
        if network.type=="RANGE":
            result = result + network.first + "_" + network.last
        elif network.type=="SUBNET":
            result = result + network.cidr
        elif network.type=="HOST":
            result = result + network.ip
        result
      securitypolicy.object_style:       true
      securitypolicy.source_object:      true
      securitypolicy.destination_object: true
      securitypolicy.service_object:     true
      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      action:                            permit


  - file_path: "2025-05-30-08.51.12-132.254.160.136-C8U31-FW-1.DCN.Edu1000E-仪征303.txt"
    mode: "Huawei"
    ipv4_area:
      - interface: "Eth-Trunk21.101"
        name: "QXDCN"
        node_name: "YZ-YiZ-C8U31-FW-1.DCN.Edu1000E"
        force: true
    ipv4_stub:
      - port_name: "Eth-Trunk21.102"
      - port_name: "Eth-Trunk21.104"
      - port_name: "Eth-Trunk21.103"
      - port_name: "Eth-Trunk21.105"
    metadata:
      type: "object"
      # base_acl_number: "3200"
      # input.nat: "natpolicy.dnat"   # Input NAT policy(nat.static.inbound, nat.static.inout)
      # output.nat: "natpolicy.snat"  # Output NAT policy(nat.static.outbound, nat.dynamic.outbound)
      # nat.enableAclGeneration: "true"
      policy_name_template: "YiZ303_policy_{SEQ:id:4:1:1:MAIN}"
      service_object_name_template: |
        result = ""
        if service.protocol.Equal("IP"):
          pass
        elif service.protocol.Equal("TCP") or service.protocol.Equal("UDP"):
          result = str(service.protocol)
          if service.hasDstPort:
            if service.dst_port.count == 1:
              result = result + "_" + service.dst_port.compact
            else:
              result = result + "_" + service.dst_port.first + "_" + service.dst_port.last
        elif service.protocol.Equal("ICMP"):
          result = str(service.protocol)
          if service.hasType:
            result = result + "_" + str(service.type)
            if service.hasCode:
              result = result + "_" + str(service.code)
        else:
          result = str(service.protocol) + "_" + str(service.protocol.number)
        result
      network_object_name_template: |
        result = "DMZ_"
        if network.type=="RANGE":
            result = result + network.first + "_" + network.last
        elif network.type=="SUBNET":
            result = result + network.cidr
        elif network.type=="HOST":
            result = result + network.ip
        result

      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      action:                            permit

      securitypolicy.use_source_address_object: false
      securitypolicy.use_destination_address_object: false
      securitypolicy.use_service_object: false
      securitypolicy.reuse_policy:                      true
      securitypolicy.enable:                            true
      securitypolicy.empty_zone_matches_any:            false
      securitypolicy.multi_source_address_object: false
      securitypolicy.multi_destination_address_object: false
      securitypolicy.multi_service_object: false
      securitypolicy.reuse_service_object: false
      securitypolicy.source_address_group_style: "member"
      securitypolicy.destination_address_group_style: "member"

      action:    permit     
      

  # - host: "192.168.100.2"
  #   username: "admin"
  #   password: "!@AsiaLink@2020"
  #   port: 22
  #   mode: "Dptech"
  #   telnet: false
  #   ipv4_stub:
  #     - port_name: "bond12"
  #   ipv4_area:
  #     - interface: "bond11"
  #       name: "DCN"
  #   snat:
  #     - from: DMZ
  #       to: DCN
  #       pool: interface

  # - host: "172.32.1.225"
  #   username: "admin"
  #   password: "!@AsiaLink@2020"
  #   port: 22
  #   mode: "SecPath"
  #   telnet: false
  #   ipv4_area:
  #     - interface: "Reth5"
  #       name: "163"
  #   ipv4_stub:
  #     - port_name: "Reth3"
  #     - port_name: "Reth4"
  #   snat:
  #     - from: DMZ
  #       to: 163
  #       pool: 58.217.205.1-58.217.205.4
  #     - from: DMZ
  #       to: ZhuanXian
  #       pool: 192.168.0.1-192.168.0.1
  #     - from: ZhuanXian
  #       to: DMZ
  #       pool: 192.168.1.245-192.168.1.254
  #     - from: 163
  #       to: DMZ
  #       pool: 192.168.1.245-192.168.1.254

  # - host: "172.32.1.7"
  #   username: "admin"
  #   password: "admin@123"
  #   authPass: "admin@123"
  #   port: 22
  #   mode: "IOS"
  #   telnet: false
  # - host: "172.32.1.2"
  #   username: "admin"
  #   password: "admin@123"
  #   authPass: "admin@123"
  #   port: 22
  #   mode: "IOS"
  #   telnet: false
  # - host: "172.32.1.10"
  #   username: "admin"
  #   password: "admin@123"
  #   authPass: "admin@123"
  #   port: 22
  #   mode: "IOS"
  #   telnet: false
  # - host: "172.32.1.11"
  #   username: "admin"
  #   password: "admin@123"
  #   authPass: "admin@123"
  #   port: 22
  #   mode: "IOS"
  #   telnet: false
  # - host: "172.32.1.12"
  #   username: "admin"
  #   password: "admin@123"
  #   authPass: "admin@123"
  #   port: 22
  #   mode: "IOS"
  #   telnet: false
  # - host: "172.32.1.25"
  #   username: "admin"
  #   password: "admin@123"
  #   authPass: "admin@123"
  #   port: 22
  #   mode: "IOS"
  #   telnet: false
  # - host: "172.32.1.26"
  #   username: "admin"
  #   password: "admin@123"
  #   authPass: "admin@123"
  #   port: 22
  #   mode: "IOS"
  #   telnet: false
  # - host: "172.32.1.8"
  #   username: "admin"
  #   password: "admin@123"
  #   authPass: "admin@123"
  #   port: 22
  #   mode: "FortiGate"
  #   telnet: false
  #   token: "r7Hnnfgym6NqNQmxGHmrxnnf0d1Qdb"


nodemap:
  name: "H3CNM"
  force: false
  task_id: 1
config_file_path: "."
# policy:
  # # source: "192.168.11.11/32"
  # source: "192.168.35.104-192.168.35.107"
  # # destination: "132.224.11.11/32"
  # destination: "132.224.22.1/32"
  # ticketNumber: HQWLTK20250327001
  # subTicket: "1"
  # service:
  #   protocol: "tcp"
  #   port: "80"

# policy:
  # source: "132.224.218.249/32"
  # destination: "132.252.45.210/32"
  # realIp: 192.168.30.10
  # realPort: 443
  # ticketNumber: HQWLTK20250327001
  # subTicket: "1"
  # service:
  #   protocol: "tcp"
  #   port: "443"
  # area: DCN
  # metadata:
  #   system_name: BSS
  #   app_name: TongyiAPP
  #   server_name: WEBUB
  #   IsUserDefineService: "true"


# policy:
  # source: "132.252.43.0/25"
  # destination: "132.224.7.1/32"
  # ticketNumber: HQWLTK20250327001
  # subTicket: "1"
  # service:
  #   protocol: "tcp"
  #   port: "8443"
  # metadata:
  #   system_name: BSS
  #   app_name: TongyiAPP
  #   server_name: WEBUB
  #   IsUserDefineService: "true"
  #   purpose: "MonitorAccess"
  #   direction: "Inbound"
# policy:
#   source: "132.254.24.53,132.252.35.26/31,132.252.136.58/31,132.252.136.93-132.252.136.98,132.252.136.135-132.252.136.137"
#   destination: "132.252.128.223-132.252.128.225,132.252.128.227-132.252.128.228,132.252.128.231-132.252.128.232"
#   ticketNumber: HQWLTK20250327001
#   area: "QXDCN"
#   subTicket: "1"
#   # inputNode: "NJ-GL4F-G16U5-FW.RP.M9010"
#   service:
#     protocol: "tcp"
#     port: "16492"
#   metadata:
#     system_name: BSS
#     app_name: TongyiAPP
#     server_name: WEBUB
#     IsUserDefineService: "true"
#     purpose: "MonitorAccess"
#     direction: "Inbound"
#  rule 3765 name GL4F-policy3765
#   action pass
#   source-zone QXMSS
#   source-zone QXDCN
#   destination-zone QXBSS
#   source-ip-host 132.254.24.53,132.252.35.26/31,132.252.136.58/31,132.252.136.93-132.252.136.98,132.252.136.135-132.252.136.137 
#   destination-ip-range 132.252.128.2231-32.252.128.225,132.252.128.227-132.252.128.228,132.252.128.231-132.252.128.232
#   destination-ip-range 132.252.128.227 132.252.128.228 
#   destination-ip-range 132.252.128.231 132.252.128.232 
#   service-port tcp destination eq 16491

# policy:
#   source: "10.128.90.2,10.130.153.124"
#   destination: "132.254.168.15-132.254.168.20"
#   ticketNumber: "NETACC_20250327_558087"
#   area: "QXDCN"
#   service:
#     protocol: "tcp"
#     port: "28084,32083,32084"
  # metadata:
  #   system_name: "YiZ303"
  #   app_name: "policy"
  #   server_name: "1073"
  #   IsUserDefineService: "true"
  #   purpose: "NETACC"
  #   direction: "Outbound"
  #   source_zone: "QXDCN"
  #   destination_zone: "QXTEST"

#  rule name YiZ303_policy_1073
#   description NETACC_20250327_558087
#   source-zone QXDCN
#   destination-zone QXTEST
#   source-address 10.128.90.2 0.0.0.0
#   source-address 10.130.153.124 0.0.0.0
#   destination-address range 132.254.168.15 132.254.168.19
#   service protocol tcp destination-port 28084 
#   service protocol tcp destination-port 32083 
#   service protocol tcp destination-port 32084 


# policy:
#   source: "132.224.3.0/26"
#   destination: "132.224.3.128/25"
#   ticketNumber: "NETACC_20250327_558087"
#   service:
#     protocol: "tcp"
#     port: "80,443"

# policy:
#   source: "132.252.130.11/32"
#   destination: "132.224.3.128/25"
#   ticketNumber: "NETACC_20250327_558087"
#   service:
#     protocol: "tcp"
#     port: "1621"


# 2025-05-30-08.48.03-132.252.20.11-NJ-JiS-E24-FW-1.RP.Edu8000E.txt
policy:
  destination: "132.252.70.0/24"
  source: "132.224.2.1-132.224.2.5,132.224.2.7/32,132.224.2.128/25"
  service:
    protocol: "tcp"
    port: "80,1621-1625"

      # security-policy
      #  rule name JiS_policy_2918
      #   source-zone QXDCN
      #   destination-zone QXGUANKONG
      #   source-address range 132.224.2.1 132.224.2.5
      #   source-address 132.224.2.7 0.0.0.0
      #   source-address 132.224.2.128 mask 255.255.255.128
      #   destination-address 132.252.70.0 mask 255.255.255.0
      #   service protocol tcp destination-port 80
      #   service protocol tcp destination-port 1621 to 1625
      #   action permit

  # 132.252.37.0/24
  # 132.224.2.0/24

# policy:
  # destination: "132.234.6.60/32"
  # source: "132.252.128.180-132.252.128.185"
  # # source: "132.224.2.7/32"
  # service:
  #   protocol: "tcp"
  #   port: "15432,15433"


#  rule 4389 name GL4F-policy4389
#   description NETACC_20250527_611783
#   action pass
#   source-zone QXBSS
#   destination-zone QXDCN
#   source-ip-range 132.252.128.180 132.252.128.185 
#   destination-ip-host 132.234.6.36 
#   destination-ip-host 132.234.6.59 
#   service-port tcp destination eq 15432
#   service-port tcp destination eq 15433